<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Josep Pueyo-Ros">

<title>ENTSAPP Reference manual</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="reference_manual_files/libs/clipboard/clipboard.min.js"></script>
<script src="reference_manual_files/libs/quarto-html/quarto.js"></script>
<script src="reference_manual_files/libs/quarto-html/popper.min.js"></script>
<script src="reference_manual_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="reference_manual_files/libs/quarto-html/anchor.min.js"></script>
<link href="reference_manual_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="reference_manual_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="reference_manual_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="reference_manual_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="reference_manual_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#knowledge-base" id="toc-knowledge-base" class="nav-link active" data-scroll-target="#knowledge-base"><span class="header-section-number">1</span> Knowledge base</a>
  <ul class="collapse">
  <li><a href="#technologies" id="toc-technologies" class="nav-link" data-scroll-target="#technologies"><span class="header-section-number">1.1</span> Technologies</a></li>
  <li><a href="#scientific-case-studies" id="toc-scientific-case-studies" class="nav-link" data-scroll-target="#scientific-case-studies"><span class="header-section-number">1.2</span> Scientific case-studies</a></li>
  <li><a href="#commercial-case-studies" id="toc-commercial-case-studies" class="nav-link" data-scroll-target="#commercial-case-studies"><span class="header-section-number">1.3</span> Commercial case-studies</a></li>
  <li><a href="#water-inputs-and-transformations" id="toc-water-inputs-and-transformations" class="nav-link" data-scroll-target="#water-inputs-and-transformations"><span class="header-section-number">1.4</span> Water inputs and transformations</a>
  <ul class="collapse">
  <li><a href="#water-types" id="toc-water-types" class="nav-link" data-scroll-target="#water-types"><span class="header-section-number">1.4.1</span> Water types</a></li>
  <li><a href="#conversions" id="toc-conversions" class="nav-link" data-scroll-target="#conversions"><span class="header-section-number">1.4.2</span> Conversions</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#selection-of-technologies" id="toc-selection-of-technologies" class="nav-link" data-scroll-target="#selection-of-technologies"><span class="header-section-number">2</span> Selection of technologies</a></li>
  <li><a href="#sec-surface-estimation" id="toc-sec-surface-estimation" class="nav-link" data-scroll-target="#sec-surface-estimation"><span class="header-section-number">3</span> Surface estimation</a>
  <ul class="collapse">
  <li><a href="#treatment-surface" id="toc-treatment-surface" class="nav-link" data-scroll-target="#treatment-surface"><span class="header-section-number">3.1</span> Treatment surface</a></li>
  <li><a href="#retention---infiltration-surface" id="toc-retention---infiltration-surface" class="nav-link" data-scroll-target="#retention---infiltration-surface"><span class="header-section-number">3.2</span> Retention - infiltration surface</a></li>
  </ul></li>
  <li><a href="#multicriteria-decision-analysis" id="toc-multicriteria-decision-analysis" class="nav-link" data-scroll-target="#multicriteria-decision-analysis"><span class="header-section-number">4</span> Multicriteria decision analysis</a>
  <ul class="collapse">
  <li><a href="#criteria" id="toc-criteria" class="nav-link" data-scroll-target="#criteria"><span class="header-section-number">4.1</span> Criteria</a>
  <ul class="collapse">
  <li><a href="#environmental-impact" id="toc-environmental-impact" class="nav-link" data-scroll-target="#environmental-impact"><span class="header-section-number">4.1.1</span> Environmental impact</a></li>
  <li><a href="#multifunctionality" id="toc-multifunctionality" class="nav-link" data-scroll-target="#multifunctionality"><span class="header-section-number">4.1.2</span> Multifunctionality</a></li>
  <li><a href="#space-requirements" id="toc-space-requirements" class="nav-link" data-scroll-target="#space-requirements"><span class="header-section-number">4.1.3</span> Space requirements</a></li>
  <li><a href="#operation-and-manteinance" id="toc-operation-and-manteinance" class="nav-link" data-scroll-target="#operation-and-manteinance"><span class="header-section-number">4.1.4</span> Operation and manteinance</a></li>
  <li><a href="#cost" id="toc-cost" class="nav-link" data-scroll-target="#cost"><span class="header-section-number">4.1.5</span> Cost</a></li>
  </ul></li>
  <li><a href="#weights" id="toc-weights" class="nav-link" data-scroll-target="#weights"><span class="header-section-number">4.2</span> Weights</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ENTSAPP Reference manual</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Josep Pueyo-Ros </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This document is work in progress. Content will evolve as the tool evolves.</p>
</div>
</div>
<section id="knowledge-base" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Knowledge base</h1>
<section id="technologies" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="technologies"><span class="header-section-number">1.1</span> Technologies</h2>
</section>
<section id="scientific-case-studies" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="scientific-case-studies"><span class="header-section-number">1.2</span> Scientific case-studies</h2>
</section>
<section id="commercial-case-studies" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="commercial-case-studies"><span class="header-section-number">1.3</span> Commercial case-studies</h2>
</section>
<section id="water-inputs-and-transformations" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="water-inputs-and-transformations"><span class="header-section-number">1.4</span> Water inputs and transformations</h2>
<section id="water-types" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="water-types"><span class="header-section-number">1.4.1</span> Water types</h3>
</section>
<section id="conversions" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="conversions"><span class="header-section-number">1.4.2</span> Conversions</h3>
</section>
</section>
</section>
<section id="selection-of-technologies" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Selection of technologies</h1>
</section>
<section id="sec-surface-estimation" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Surface estimation</h1>
<section id="treatment-surface" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="treatment-surface"><span class="header-section-number">3.1</span> Treatment surface</h2>
</section>
<section id="retention---infiltration-surface" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="retention---infiltration-surface"><span class="header-section-number">3.2</span> Retention - infiltration surface</h2>
<p>The volume that the technology can manage is calculated as follows:</p>
<p><span class="math display">\[
Q = S(\frac{I· 24}{1000} + C · D)
\]</span> where:</p>
<ul>
<li><em>Q</em> = Daily flow that the technology can retain or infiltrate (m<sup>3</sup>3/day).</li>
<li><em>S</em> = surface of the technology (m<sup>2</sup>2)</li>
<li><em>I</em> = infiltration rate of the receiving environment (mm/hour)</li>
<li><em>C</em> = storage capacity of the technology (m<sup>3</sup>/m<sup>3</sup>)</li>
<li><em>D</em> = depth of the technology (in m)</li>
</ul>
<p>Note that if the infiltration is not allowed in the receiving environment, <em>I</em> can be set to zero and then only detention is considered. The equation assumes that the technology is empty when the rain starts and that the rain lasts for 24 hours.</p>
<p>From the previous equation, the surface can be estimated as follows:</p>
<p><span class="math display">\[
S = \frac{Q}{0.024I + C · D}
\]</span> The output contains the surface needed to retain or infiltrate the volume reported and the daily volume that can be retained or infiltrated by the technology with the high interval of the surface.</p>
<p>When the user also provides the available area, the surface estimated is to manage all the volume reported, regardless of the available area. However, the <code>daily_flow</code> reports the maximum volume that can be retained or infiltrated by the technology using the available area. If the surface needed is lower than the available area, the daily flow always equal to the volume reported by the user. A flag named <code>enough_area</code> indicates when the available area is larger than the surface needed to manage the reported flow.</p>
</section>
</section>
<section id="multicriteria-decision-analysis" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Multicriteria decision analysis</h1>
<p>Multicriteria decision analysis (MCDA) is a method to weight different criteria to get a final score for each technology. Each criteria is weighted between 0 and 5 regarding the importance that the criteria has in the use case.</p>
<section id="criteria" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="criteria"><span class="header-section-number">4.1</span> Criteria</h2>
<section id="environmental-impact" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="environmental-impact"><span class="header-section-number">4.1.1</span> Environmental impact</h3>
<p>It is calculated as a combination of energy use, eutrophication risks and biohazard risks, at this moment it is not calculated from rain and runoff technologies because all variables used have the same value and, therefore, the environmental impact is the same for all technologies:</p>
<p><span class="math display">\[
EI = \frac{(1 - e) + r_{NH_4} + r_{NO_2} + (1 - \frac{br}{3})}{4}
\]</span></p>
<p>Where <span class="math inline">\(EI\)</span> is environmental impact (<span class="math inline">\(\in[0,1]\)</span>) being 1 the lowest impact; <span class="math inline">\(e\)</span> is energy use (<span class="math inline">\(\in{0,1}\)</span>); <span class="math inline">\(r_{NH_4}\)</span> is the capacity of the technology to remove ammonia (<span class="math inline">\(\in\{0,1\}\)</span>); <span class="math inline">\(r_{NO_2}\)</span> is the capacity of the technology to remove nitrates (<span class="math inline">\(\in\{0,1\}\)</span>); and <span class="math inline">\(br\)</span> is the biohazard risk of the technology (<span class="math inline">\(\in[0,3]\)</span>).</p>
</section>
<section id="multifunctionality" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="multifunctionality"><span class="header-section-number">4.1.2</span> Multifunctionality</h3>
<p>Multifunctionality considers the capacity of the tehcnology to provide cobenefits and ecosystem services. It is calculated as an average of all cobenefits:</p>
<p><span class="math display">\[
M = \frac{1}{N}\sum_{i = 1}^N{\frac{cb_i}{3}}
\]</span></p>
<p>Where <span class="math inline">\(M\)</span> stands for multifunctionality (<span class="math inline">\(\in[0,1]\)</span>) being 1 the highest multifunctionality; <span class="math inline">\(N\)</span> is the number of considered cobenefits; and <span class="math inline">\(cb_i\)</span> is the score for the cobenefit <span class="math inline">\(i\)</span> (<span class="math inline">\(\in[0,3]\)</span>).</p>
</section>
<section id="space-requirements" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="space-requirements"><span class="header-section-number">4.1.3</span> Space requirements</h3>
<p>Space requirements is the surface needed for the technology. In case, the scenario has enough information to estimate the surface, the estimated mean surface is used. Otherwise, the ratio <span class="math inline">\(m2/pe\)</span> for each technology is used instead. The surfaces of compared technologies are normalized as follows:</p>
<p><span class="math display">\[
SR_i = \frac{s_{min}}{s_i}
\]</span> where <span class="math inline">\(SR_i\)</span> is the space requirements (<span class="math inline">\(\in(0,1]\)</span>) for technology <span class="math inline">\(i\)</span>; <span class="math inline">\(s_{min}\)</span> is the minimum surface among all compared technologies and <span class="math inline">\(s_i\)</span> is the surface of technology <span class="math inline">\(i\)</span>. when the data to estimate the surface is not provided, the ratio of <span class="math inline">\(m^2/pe\)</span> is used for treatment technologies (larger ratio equals to smaller score) and <span class="math inline">\(sc * d\)</span> is used for stormwater management technologies. See <a href="#sec-surface-estimation">Section&nbsp;3</a> for more details.</p>
</section>
<section id="operation-and-manteinance" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="operation-and-manteinance"><span class="header-section-number">4.1.4</span> Operation and manteinance</h3>
<p>Operation and manteinance is the level of difficulty in keep the technology properly working. It is estimated as a combination of required manpower and required skills:</p>
<p><span class="math display">\[
OM = 1 - \frac{m + s}{6}
\]</span> Where <span class="math inline">\(OM\)</span> is the operation and manteinance score (<span class="math inline">\(\in[0,1]\)</span>) being 1 the lowest operation and manteinance requirements; <span class="math inline">\(m\)</span> is the level of required manpower (<span class="math inline">\(\in[0,3]\)</span>); and <span class="math inline">\(s\)</span> is the level of required skills (<span class="math inline">\(\in[0,3]\)</span>).</p>
</section>
<section id="cost" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="cost"><span class="header-section-number">4.1.5</span> Cost</h3>
<p>The cost is calculated as the total construction cost using the estimated surface. The costs for all technologies are normalized regarding the technology with the minimal cost.</p>
<p><span class="math display">\[
\hat{c}_i = \frac{c_{min}}{c_i}
\]</span> where <span class="math inline">\(\hat{c}_i\)</span> is the normalized construction cost (<span class="math inline">\(\in(0,1]\)</span>) for technology <span class="math inline">\(i\)</span>; <span class="math inline">\(c_{min}\)</span> is the minimum cost among all compared technologies and <span class="math inline">\(c_i\)</span> is the cost of technology <span class="math inline">\(i\)</span>.</p>
</section>
</section>
<section id="weights" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="weights"><span class="header-section-number">4.2</span> Weights</h2>
<p>Each criteria is weighted by the user according to the priorities of the specific case. Each criteria can be weighted using a 5-point Likert scale from “Not important at all” to “Very important”. Then this information is used to weight the score of each criteria.</p>
<p>Then this weights are converted to proportions (<span class="math inline">\(\Sigma{w} = 1\)</span>). Therefore, weighted all criteria as very important get the same results that weighted all of them as not important:</p>
<p><span class="math display">\[
p_{wc} = \frac{w_c}{\Sigma{w}}
\]</span> where <span class="math inline">\(p_{wc}\)</span> is the proportion (<span class="math inline">\(\in[0,1]\)</span>) of the weight for criteria <span class="math inline">\(c\)</span>; <span class="math inline">\(w_c\)</span> is the weight (<span class="math inline">\(\in[0,5]\)</span>) for criteria <span class="math inline">\(c\)</span> and <span class="math inline">\(\Sigma{w}\)</span> is the sum of the weights of all criteria.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>